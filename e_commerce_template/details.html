<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0" />
    <link rel="stylesheet" type="text/css" href="css_details/onboarding.css" />
    <link rel="stylesheet" type="text/css" href="css_details/styleguide.css" />
    <link rel="stylesheet" type="text/css" href="css_details/globals.css" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <style>
        .bitmap {
            max-width: 50%;
            height: auto;
            border-radius: 10px;
            display: block;
            margin: 0 auto;
            position: relative;
        }
        .onboarding .heading-2 {
            font-family: var(--font-family-abhaya_libre_extrabold-regular);
            font-size: var(--font-size-xl);
            font-weight: 400;
            letter-spacing: 0;
            line-height: normal;
            text-align: center; /* 居中文本 */
            display: block; /* 确保元素是块级元素 */
            width: 100%; /* 确保宽度为100% */
            white-space: normal; /* 确保文本可以换行 */
            margin: 20px auto; /* 确保容器居中并增加顶部和底部外边距 */
        }
        .arrow-right {
            position: absolute;
            top: 50%;
            right: 10px;
            transform: translateY(-50%);
            cursor: pointer;
            font-size: 24px;
            color: #000;
            background: rgba(255, 255, 255, 0.5);
            padding: 5px;
            border-radius: 50%;
        }
        .onboarding .body-text {
            color: #96a7af;
            font-family: var(--font-family-abeezee);
            font-size: var(--font-size-m);
            font-weight: 400;
            letter-spacing: 0;
            line-height: 24px;
            text-align: left; /* 确保文本左对齐 */
            width: calc(100% - 20px); /* 容器宽度比两边少10px */
            margin: 20px auto; /* 上下外边距为20px，左右自动居中 */
            padding: 0 10px; /* 内边距增加10px，确保内容不会紧贴容器边缘 */
        }
    </style>
</head>
<body style="margin: 0; background: #ffffff">
    <input type="hidden" id="anPageName" name="page" value="onboarding" />
    <div class="container-center-horizontal">
        <div class="onboarding screen">
            <div class="overlap-group">
                <div class="rectangle"></div>
                <p id="description" class="body-text">Description: Loading...</p>
                <div id="item-name" class="heading-3">Loading...</div>
                <div class="spacer">aa</div>
                <div id="price" class="heading-1 heading-2">Loading...</div>
                <!-- <div id="item-name-repeat" class="heading-2">Loading...</div> -->
                <div class="sign-in">
                    <div class="back"></div>
                    <div class="next_-button"><div class="next">MEETUP WITH SELLER!</div></div>
                </div>
                <div class="x3-medium_-cards">
                    <div class="image-container">
                        <img id="item-image" class="bitmap" src="img/bitmap@2x.png" alt="Bitmap" />
                        <div class="arrow-right" id="arrow-right">&#8250;</div> <!-- 右箭头 -->
                    </div>
                </div>
                <img class="store-line-card-heart" src="img/store-2line-1card-heart.svg" alt="Store-Line-Card Heart" />
            </div>
        </div>
    </div>
    <script>
        $(document).ready(function() {
            // 解析URL中的查询参数
            const urlParams = new URLSearchParams(window.location.search);
            const itemId = urlParams.get('item_id');

            if (itemId) {
                // 使用商品ID从API获取商品详情
                $.ajax({
                    url: `http://127.0.0.1:5000/api/items`,
                    method: 'GET',
                    success: function(data) {
                        const item = data.find(item => item.item_id == itemId);
                        if (item) {
                            console.log('Item details:', item);
                            $('#item-name').text(item.name);
                            $('#price').text(item.estimated_price);
                            $('#description').text('Description: ' + item.description);
                            $('#item-name-repeat').text(item.name);
                            $('#item-image').attr('src', item.image_url);

                            // 点击箭头切换图片
                            $('#arrow-right').click(function() {
                                const currentSrc = $('#item-image').attr('src');
                                if (currentSrc === item.image_url) {
                                    $('#item-image').attr('src', item.original_img);
                                } else {
                                    $('#item-image').attr('src', item.image_url);
                                }
                            });
                        } else {
                            $('#description').text('Item not found.');
                        }
                    },
                    error: function(error) {
                        console.error('Error fetching item details:', error);
                        $('#description').text('Error loading item details.');
                    }
                });
            } else {
                $('#description').text('Item ID is missing in the URL.');
            }

            // 点击按钮跳转到指定URL
            $('.next_-button').click(function() {
                window.location.href = 'http://127.0.0.1:5502/';
            });
        });
    </script>
</body>
</html>